COPY	StART	1000
FIRST	STL		RETADR
		LDB		#LENGTH
		BASE	LENGTH
CLOOP	+JSUB 	RDREC
		LDA		=C'GH'
		COMP	#0
		JEQ		ENDFIL
		+JSUB	WRREC
		J		CLOOP
ENDFIL	LDA		=c'EOF'
		STA		BUFFER
		LDA		3
		STA		LENGTH
		+JSUB	WRREC
		LTORG
		J		@RETADR
		LTORG
RETADR	ReSW	1
LENGTH	RESW	1
BUFFER	RESB	4096
TESTME	WORD	546
TESTAR	WORD	65,98,45
RDREC	CLEAR	X
		CLEAR	A
		CLEAR	S
		+LDT	=C'EOF'
RLOOP	TD		INPUT
		JEQ		RLOOP
		RD		INPUT
		COMPR	A,S
		JEQ		EXIT
		STCH	BUFFER
		TIXR	T
		JLT		RLOOP
EXIT	STX		LENGTH
		RSUB
INPUT	BYTE	X'F1'
WRREC	CLEAR	X
		LDT		LENGTH
WLOOP	TD		OUTPUT
		JEQ		WLOOP
		LDCH	BUFFER,X
		WD		OUTPUT
		TIXR	T
		JLT		WLOOP
		RSUB
OUTPUT	BYTE	X'05'
		END		FIRST